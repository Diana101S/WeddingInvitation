<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wedding of Daniel & Diana</title>

  <!-- OG -->
  <meta property="og:title" content="Wedding of Daniel & Diana" />
  <meta property="og:description" content="2026.06.06 | [ì˜ˆì‹ì¥/í™€ëª…]" />
  <meta property="og:image" content="á„€á…©á†¼á„€á…¢á„…á…µá†¼á„á…³_á„á…¥á†¼á„á…¥á†¸á„Œá…¡á†¼á„†á…¦á„‹á…µá†«á„‰á…¡á„Œá…µá†«.png" />
  <meta property="og:url" content="https://Diana101S.github.io/WeddingInvitation/" />
  <meta property="og:type" content="website" />
  <meta name="format-detection" content="telephone=no" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&family=Playfair+Display:wght@600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#FFFFFF;
      --ink:#0f172a;--sub:#334155;--brand:#86AEDB;--soft:#f1f5f9;--line:#e7e7e7;
      --muted:#6B7280;--accent:#E9C89B;--rule:#E6D7BD;--gold:#B9A06B;
      --maxw:720px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);
      font-family:Pretendard,system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif}
    img{max-width:100%;display:block}
    a{color:inherit;text-decoration:none}
    .wrap{max-width:var(--maxw);margin:0 auto}

    /* HERO */
    .hero{position:relative}
    .hero img{width:100%;height:auto}
    .badge{position:absolute;right:16px;bottom:16px;background:#ffffffdd;color:var(--ink);padding:8px 12px;border-radius:999px;font-weight:600;font-size:14px;backdrop-filter:saturate(180%) blur(6px)}

    /* Layout */
    .section{padding:28px 16px}

    /* Buttons */
    .btn{display:inline-flex;align-items:center;justify-content:center;height:44px;padding:0 14px;border-radius:10px;border:1px solid var(--line);background:#fff;cursor:pointer}
    .btn.brand{background:var(--brand);border-color:var(--brand);color:#fff;font-weight:700}

    /* âŒ ì•„ì´ì½˜ ì „ìš© ë²„íŠ¼ */
    .icon-btn{
      display:inline-flex;align-items:center;justify-content:center;
      width:28px;height:28px;border:1px solid var(--line);
      border-radius:8px;background:#fff;cursor:pointer;line-height:1;
    }
    .icon-btn:hover{background:#fee2e2;border-color:#fecaca}

    .muted{color:var(--sub)}
    .map{border:0;width:100%;height:280px;border-radius:12px}

    /* English invite block */
    .eng-invite{padding:20px 0}
    .eng-invite .inv-label{
      font-family:"Playfair Display", serif;color:var(--gold);letter-spacing:.28em;
      text-transform:uppercase;font-weight:700;text-align:center;font-size:clamp(13px,2vw,16px);margin:0 0 18px;
    }
    .eng-invite .headline{
      font-family:"Playfair Display", serif;font-weight:700;letter-spacing:.18em;text-transform:uppercase;
      color:#999; font-size:clamp(14px,2.3vw,18px);margin:0 0 24px;text-align:center
    }
    .eng-invite .line-1{
      font-family:"Playfair Display", serif;font-weight:700;font-size:clamp(18px,3.8vw,32px);
      letter-spacing:.12em;line-height:1.5;margin:0 0 18px;text-align:center;color:var(--ink)
    }
    .eng-invite .line-2{
      font-family:"Inter", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      font-size:clamp(16px,2.6vw,19px);line-height:1.9;letter-spacing:.02em;margin:0;text-align:center;color:var(--ink)
    }
    .orn{position:relative;height:28px;margin:0 auto 28px;width:min(360px,70%);opacity:.95}
    .orn::before,.orn::after{content:"";position:absolute;top:50%;height:1px;width:40%;background:linear-gradient(90deg,transparent,var(--rule));transform:translateY(-50%)}
    .orn::before{left:0}
    .orn::after{right:0;background:linear-gradient(90deg,var(--rule),transparent)}
    .orn .dot{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:8px;height:8px;background:var(--accent);border-radius:2px;box-shadow:0 0 0 4px rgba(233,200,155,.15)}

    /* Grid */
    .card{background:transparent;border:none;padding:0}
    .grid{display:grid;gap:12px}
    .grid.two{grid-template-columns:1fr 1fr}

    /* Calendar section */
    .calendar{display:grid;place-items:center;gap:14px}
    .calendar .cap{font-size:14px;color:#64748b}
    .calendar img,.calendar svg{max-width:520px;width:100%;height:auto}

    /* Gallery */
    .gallery{display:grid;gap:8px;grid-template-columns:repeat(3,1fr)}
    .gallery img{width:100%;aspect-ratio:1/1;object-fit:cover;border-radius:8px}

    /* Guest Book */
    .gbook { padding: 28px 16px; }
    .gbook .gb-title{
      font-family:"Playfair Display", serif;color:#B9A06B;letter-spacing:.28em;text-transform:uppercase;
      font-weight:700;text-align:center;font-size:clamp(13px,2vw,16px);margin:0 0 18px;
    }
    .gbook .form{display:grid;gap:12px;max-width:var(--maxw);margin:0 auto;}
    .gbook .field{display:grid;gap:6px}
    .gbook input,.gbook textarea{width:100%;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fff;font-size:16px}
    .gbook .msg{margin-top:10px;font-size:14px}
    .gbook .msg.ok{color:#047857}
    .gbook .msg.err{color:#b91c1c}

    /* ê²Œì‹œê¸€ ë¦¬ìŠ¤íŠ¸ */
    .gb-list{margin-top:18px;padding:0;list-style:none;display:grid;gap:10px}
    .gb-item{border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff}
    .gb-item .who{font-weight:700;margin:0 0 6px;display:flex;justify-content:space-between;gap:8px}
    .gb-item .txt{margin:0;color:#0f172a;line-height:1.6;white-space:pre-wrap}
    .gb-item .time{margin-top:6px;font-size:12px;color:#64748b}

    .footer{padding:40px 16px 80px;color:#475569;text-align:center}
    .disclaimer{font-size:12px;color:#64748b;margin-top:16px}
    .sticky-share{position:sticky;bottom:0;background:#ffffffcc;border-top:1px solid var(--line);backdrop-filter:saturate(180%) blur(6px)}
    .sticky-share .bar{max-width:var(--maxw);margin:0 auto;display:flex;gap:8px;padding:10px 12px}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- HERO -->
    <header class="hero">
      <img src="á„€á…©á†¼á„€á…¢á„…á…µá†¼á„á…³_á„á…¥á†¼á„á…¥á†¸á„Œá…¡á†¼á„†á…¦á„‹á…µá†«á„‰á…¡á„Œá…µá†«.png?v=2" alt="ì»¤ë²„ ì´ë¯¸ì§€" />
      <div class="badge">2026.06.06 â€¢ [ì˜ˆì‹ì¥]</div>
    </header>

    <!-- English invite -->
    <section class="section">
      <div class="eng-invite" aria-label="English invitation">
        <p class="inv-label">INVITATION</p>
        <div class="orn" aria-hidden="true"><span class="dot"></span></div>
        <p class="headline">Youâ€™re invited to celebrate with us.</p>
        <h2 class="line-1">Years of love brought us here.</h2>
        <p class="line-2">Today, weâ€™re celebrating in <strong>Busan, South Korea</strong> on <strong>June 6, 2026</strong>.</p>
        <div class="orn" style="margin:28px auto 0" aria-hidden="true"><span class="dot"></span></div>
      </div>
    </section>

    <!-- Calendar -->
    <section class="section">
      <div class="calendar">
        <img src="calendar.png" alt="June 2026 calendar with heart on 6th" />
        <div class="cap">Save the Date â€” 2026.06.06</div>
      </div>
    </section>

    <!-- When & Where -->
    <section class="section">
      <div class="card">
        <p class="muted" style="margin:0 0 6px">When &amp; Where</p>
        <div class="grid two">
          <div>
            <div class="muted">ì¼ì‹œ</div>
            <h3 style="margin:6px 0 0">2026.06.06 (í† ) â€¢ 13:00</h3>
          </div>
          <div>
            <div class="muted">ì¥ì†Œ</div>
            <h3 style="margin:6px 0 0">[GRAND BLANC ê·¸ëœë“œ ë¸”ë‘] [Mirabelle Garden ë¯¸ë¼ë²¨ê°€ë“ ]</h3>
          </div>
        </div>
        <div style="height:12px"></div>
        <div class="grid two">
          <a class="btn brand" id="btnAddCal" href="#">ìº˜ë¦°ë”ì— ì €ì¥</a>
          <a class="btn" target="_blank" rel="noopener" href="https://maps.google.com/?q=%EC%98%88%EC%8B%9D%EC%9E%A5">ì§€ë„ ì—´ê¸°</a>
        </div>
      </div>
    </section>

    <!-- Directions -->
    <section class="section">
      <div class="card">
        <p class="muted" style="margin:0 0 6px">Directions</p>
        <iframe
            class="map"
            loading="lazy"
            allowfullscreen
            referrerpolicy="no-referrer-when-downgrade"
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3261.6071287621585!2d129.12945411139236!3d35.166417572644185!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x356892c7a3bb7249%3A0xaffba3b439d3a200!2z6re4656c65Oc67iU656RIOybqOuUqe2ZgA!5e0!3m2!1sko!2skr!4v1762822591444!5m2!1sko!2skr">
        </iframe>
        <p class="muted" style="margin-top:8px">ëŒ€ì¤‘êµí†µ/ì£¼ì°¨ ì•ˆë‚´ ë“±ì„ ì—¬ê¸°ì— ì ì–´ ì£¼ì„¸ìš”.</p>
      </div>
    </section>

    <!-- Gallery -->
    <section class="section">
      <div class="card">
        <p class="muted" style="margin:0 0 6px">Gallery</p>
        <div class="gallery">
          <img src="https://images.unsplash.com/photo-1522335789203-aabd1fc54bc9?q=80&w=800&auto=format&fit=crop" alt="ì‚¬ì§„ 1">
          <img src="https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?q=80&w=800&auto=format&fit=crop" alt="ì‚¬ì§„ 2">
          <img src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=800&auto=format&fit=crop" alt="ì‚¬ì§„ 3">
        </div>
      </div>
    </section>

    <!-- Account Info (ì„ íƒ) -->
    <section class="section">
      <div class="card">
        <p class="muted" style="margin:0 0 6px">Account Info (ì„ íƒ)</p>
        <ul class="list" style="list-style:none;padding:0;margin:12px 0 0">
          <li class="kv" style="display:flex;justify-content:space-between;gap:12px;padding:8px 0">
            <span>ì‹ ë‘ì¸¡</span><strong>OOì€í–‰ 123-456-789012 (í™ê¸¸ë™)</strong>
          </li>
          <li class="kv" style="display:flex;justify-content:space-between;gap:12px;padding:8px 0;border-top:1px dashed var(--line)">
            <span>ì‹ ë¶€ì¸¡</span><strong>OOì€í–‰ 987-654-321098 (ê¹€ë¯¼ì§€)</strong>
          </li>
        </ul>
      </div>
    </section>

    <!-- Guest Book -->
    <section class="section gbook" id="guestbook">
      <p class="gb-title">Guest Book</p>

      <form id="gbForm" class="form" novalidate>
        <div class="field">
          <input type="text" id="gb_name" name="name" placeholder="Your name" required />
        </div>
        <div class="field">
          <input
            type="password"
            id="gb_pin"
            name="pin"
            inputmode="numeric"
            minlength="4"
            maxlength="6"
            placeholder="Passcode (4â€“6 digits)"
            required
          />
        </div>
        <div class="field">
          <textarea id="gb_message" name="message" rows="3" placeholder="Write a message for the couple" required></textarea>
        </div>

        <button id="gbSubmit" class="btn brand" type="submit">Leave a Message</button>

        <p id="gbOk"  class="msg ok"  hidden>Thank you! Your message has been posted.</p>
        <p id="gbErr" class="msg err" hidden>Something went wrong. Please try again.</p>
      </form>

      <!-- ë©”ì‹œì§€ ë¦¬ìŠ¤íŠ¸ -->
      <ul id="gbList" class="gb-list"></ul>
    </section>

    <!-- RSVP ë²„íŠ¼ -->
    <section class="section" id="rsvp-cta">
      <div class="card" style="text-align:center">
        <a class="btn brand" href="./rsvp.html">Open RSVP Form</a>
      </div>
    </section>

    <!-- Sticky share -->
    <div class="sticky-share">
      <div class="bar">
        <button class="btn" id="btnCopy">ë§í¬ ë³µì‚¬</button>
        <a class="btn brand" href="#top">ë§¨ ìœ„ë¡œ</a>
      </div>
    </div>

    <footer class="footer">
      <div>ê°ì‚¬í•©ë‹ˆë‹¤. ì•ˆì „í•˜ê²Œ ì˜¤ì„¸ìš” ğŸ™</div>
      <div class="disclaimer">ì—¬ê¸° ë¬¸êµ¬ ê°€ëŠ¥</div>
    </footer>
  </div>

  <script>
    // ë§í¬ ë³µì‚¬
    document.getElementById('btnCopy').addEventListener('click', async () => {
      try { await navigator.clipboard.writeText(location.href); alert('ë§í¬ ë³µì‚¬ ì™„ë£Œ'); }
      catch { alert('ë³µì‚¬ ì‹¤íŒ¨. ì£¼ì†Œë¥¼ ê¸¸ê²Œ ëˆŒëŸ¬ ë³µì‚¬í•´ ì£¼ì„¸ìš”.'); }
    });

    // ìº˜ë¦°ë”(ICS)
    document.getElementById('btnAddCal')?.addEventListener('click', () => {
      const title='Wedding of Daniel & Diana';
      const start=new Date(2026,5,6,13,30);
      const end=new Date(2026,5,6,15,30);
      const loc='[ì˜ˆì‹ì¥/í™€ëª…]';
      const pad=n=>String(n).padStart(2,'0');
      const toICS=d=>`${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}T${pad(d.getHours())}${pad(d.getMinutes())}00`;
      const ics=`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Mobile Invitation//KO
BEGIN:VEVENT
UID:${Date.now()}@inv
DTSTAMP:${toICS(new Date())}
DTSTART:${toICS(start)}
DTEND:${toICS(end)}
SUMMARY:${title}
LOCATION:${loc}
END:VEVENT
END:VCALENDAR`;
      const blob=new Blob([ics],{type:'text/calendar'}); const url=URL.createObjectURL(blob);
      const a=document.createElement('a'); a.href=url; a.download='wedding-invite.ics'; a.click(); URL.revokeObjectURL(url);
    });
  </script>

  <!-- Supabase Guest Book: ì €ì¥ + ì‚­ì œ + ìƒˆë¡œê³ ì¹¨ ë¡œë“œ -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

    // â¬‡â¬‡ ì‹¤ì œ ê°’ìœ¼ë¡œ êµì²´ â¬‡â¬‡
    const SUPABASE_URL = "https://khddckyznivjoluwtvxo.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtoZGRja3l6bml2am9sdXd0dnhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3MTk1NDYsImV4cCI6MjA3ODI5NTU0Nn0.zblwD4ETNzl1YlFBTfpqvxkvGPrE1RhawPLC9_iUxoE";
    // â¬†â¬† ì‹¤ì œ ê°’ìœ¼ë¡œ êµì²´ â¬†â¬†

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    async function sha256(str){
      const data = new TextEncoder().encode(str);
      const hash = await crypto.subtle.digest('SHA-256', data);
      return [...new Uint8Array(hash)].map(b=>b.toString(16).padStart(2,'0')).join('');
    }

    const listEl = document.getElementById('gbList');

    // ë©”ì‹œì§€ ì¹´ë“œ ë Œë”ëŸ¬(âŒ ì•„ì´ì½˜ ì‚­ì œ ë²„íŠ¼ í¬í•¨)
    function prependMessage({id, name, message, created_at}){
      const li = document.createElement('li');
      li.className = 'gb-item';
      if (id) li.dataset.id = id;
      const when = created_at ? new Date(created_at) : new Date();
      const safe = message.replace(/</g,'&lt;').replace(/>/g,'&gt;');
      li.innerHTML = `
        <p class="who">
          <span>${name}</span>
          <button class="icon-btn btn-delete" type="button" aria-label="Delete">âŒ</button>
        </p>
        <p class="txt">${safe}</p>
        <div class="time">${when.toLocaleString()}</div>
      `;
      listEl.prepend(li);
    }

    // ì´ˆê¸° ë¡œë“œ: ì„œë²„ì—ì„œ ìµœê·¼ ê¸€ ê°€ì ¸ì˜¤ê¸° (ì½ê¸°ìš© RPC)
    async function loadLatest(limit=30){
      const { data, error } = await supabase.rpc('list_guestbook', { limit_count: limit });
      if (error) {
        console.error('list_guestbook error:', error);
        return;
      }
      listEl.innerHTML = '';
      (data || []).forEach(prependMessage);
    }

    const form = document.getElementById('gbForm');
    const btn  = document.getElementById('gbSubmit');
    const ok   = document.getElementById('gbOk');
    const err  = document.getElementById('gbErr');

    // ì œì¶œ â†’ ì‚½ì…(í´ë¼ UUID) â†’ ì¦‰ì‹œ ë Œë”
    form?.addEventListener('submit', async (e)=>{
      e.preventDefault();
      ok.hidden = true; err.hidden = true;

      const name = document.getElementById('gb_name').value.trim();
      const pin  = document.getElementById('gb_pin').value.trim();
      const msg  = document.getElementById('gb_message').value.trim();

      if(!name || !pin || !msg){
        err.textContent = "ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
        err.hidden = false; return;
      }
      if(pin.length < 4 || pin.length > 6){
        err.textContent = "ë¹„ë°€ë²ˆí˜¸ëŠ” 4~6ìë¦¬ë¡œ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
        err.hidden = false; return;
      }

      btn.disabled = true; btn.textContent = "ì „ì†¡ ì¤‘â€¦";

      try{
        const pin_hash = await sha256(pin);
        const clientId = crypto.randomUUID();

        const { error } = await supabase
          .from('guestbook')
          .insert({ id: clientId, name, message: msg, pin_hash });

        if (error) {
          console.error(error);
          err.textContent = "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.";
          err.hidden = false;
        } else {
          prependMessage({
            id: clientId,
            name,
            message: msg,
            created_at: new Date().toISOString()
          });
          form.reset();
          ok.hidden = false;
        }
      }catch(e2){
        console.error(e2);
        err.textContent = "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.";
        err.hidden = false;
      }finally{
        btn.disabled = false; btn.textContent = "Leave a Message";
      }
    });

    // ì‚­ì œ(âŒ í´ë¦­ â†’ PIN ì…ë ¥ â†’ RPC)
    document.addEventListener('click', async (e)=>{
      const btn = e.target.closest('.btn-delete');
      if (!btn) return;

      const li = btn.closest('.gb-item');
      const id = li?.dataset?.id;
      if (!id) { alert('ì‚­ì œ IDê°€ ì—†ìŠµë‹ˆë‹¤.'); return; }

      const pin = prompt('Enter your passcode to delete this message');
      if (!pin) return;

      btn.disabled = true;
      const prevLabel = btn.textContent;
      btn.textContent = 'â€¦';

      const { data, error } = await supabase.rpc('delete_guestbook_entry', {
        _id: id,
        _pin: pin
      });

      if (error) {
        console.error('delete_guestbook_entry error:', error);
        alert('Delete failed. Please try again.');
      } else if (data === true) {
        li.remove();
      } else {
        alert('Passcode did not match.');
      }

      btn.disabled = false;
      btn.textContent = prevLabel || 'âŒ';
    });

    // ì²˜ìŒ ë¡œë“œ ì‹œ ì„œë²„ ê¸€ í‘œì‹œ
    loadLatest();
  </script>
</body>
</html>
