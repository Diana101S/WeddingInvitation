<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wedding of Daniel & Diana</title>

  <!-- OG -->
  <meta property="og:title" content="Wedding of Daniel & Diana" />
  <!-- <meta property="og:description" content="2026.06.06 | [Venue / Hall Name]" /> -->
  <meta property="og:image" content="·ÑÄ·Ö©·Üº·ÑÄ·Ö¢·ÑÖ·Öµ·Üº·Ñè·Ö≥_·Ñé·Ö•·Üº·Ñé·Ö•·Ü∏·Ñå·Ö°·Üº·ÑÜ·Ö¶·Ñã·Öµ·Ü´·Ñâ·Ö°·Ñå·Öµ·Ü´.png" />
  <meta property="og:url" content="https://Diana101S.github.io/WeddingInvitation/" />
  <meta property="og:type" content="website" />
  <meta name="format-detection" content="telephone=no" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&family=Playfair+Display:wght@600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#FFFFFF;
      --ink:#0f172a;--sub:#334155;--brand:#86AEDB;--soft:#f1f5f9;--line:#e7e7e7;
      --muted:#6B7280;--accent:#E9C89B;--rule:#E6D7BD;--gold:#B9A06B;
      --maxw:720px;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0;padding:0;background:var(--bg);color:var(--ink);
      font-family:Pretendard,system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif
    }
    img{max-width:100%;display:block}
    a{color:inherit;text-decoration:none}
    .wrap{max-width:var(--maxw);margin:0 auto}

    /* HERO */
    .hero{
      position:relative;
      overflow:hidden;
    }
    .hero img{
      width:100%;
      height:auto;
      position:relative;
      z-index:1;
    }
    .badge{
      position:absolute;right:16px;bottom:16px;
      background:#ffffffdd;color:var(--ink);
      padding:8px 12px;border-radius:999px;
      font-weight:600;font-size:14px;
      backdrop-filter:saturate(180%) blur(6px);
      z-index:3;
    }

    /* Hero cherry blossom petals (HERO ÏïàÏóêÏÑúÎßå) */
    .hero-petal-layer{
      position:absolute;
      inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index:2;
    }
    /* Îàà + Î≤öÍΩÉ Ï§ëÍ∞Ñ ÎäêÎÇå */
    .petal{
      position:absolute;
      top:-8vh;
      width:12px;
      height:16px;
      background:radial-gradient(circle at 30% 30%, #ffffff, #ffeef7 60%, #ffd7e5 100%);
      border-radius:55% 45% 60% 40%;
      opacity:0.7;
      box-shadow:0 0 4px rgba(255,220,235,0.6);
      animation:petal-fall linear infinite;
      transform-origin:center;
    }
    @keyframes petal-fall{
      0%{
        transform:translate3d(0,-10vh,0) rotate(0deg);
        opacity:0;
      }
      15%{
        opacity:0.8;
      }
      100%{
        transform:translate3d(0,110vh,0) rotate(280deg);
        opacity:0;
      }
    }

    /* Layout */
    .section{padding:28px 16px}

    /* Buttons */
    .btn{
      display:inline-flex;align-items:center;justify-content:center;
      height:44px;padding:0 14px;
      border-radius:10px;border:1px solid var(--line);
      background:#fff;cursor:pointer
    }
    .btn.brand{background:var(--brand);border-color:var(--brand);color:#fff;font-weight:700}

    /* Icon button */
    .icon-btn{
      position:relative;
      width:24px;height:24px;
      border:none;background:transparent;cursor:pointer;
      padding:0;line-height:1;
    }
    .icon-btn::before,.icon-btn::after{
      content:"";position:absolute;left:50%;top:50%;
      width:14px;height:1px;background:#0f172a;opacity:.85;transform-origin:center;
    }
    .icon-btn::before{ transform:translate(-50%,-50%) rotate(45deg); }
    .icon-btn::after { transform:translate(-50%,-50%) rotate(-45deg); }
    .icon-btn:hover::before,.icon-btn:hover::after{ opacity:1; }
    .icon-btn:focus-visible{
      outline:2px solid #cbd5e1; outline-offset:2px; border-radius:6px;
    }

    .muted{color:var(--sub)}
    .map{border:0;width:100%;height:280px;border-radius:12px}

    /* English invite block */
    .eng-invite{padding:20px 0}
    .eng-invite .inv-label{
      font-family:"Playfair Display", serif;color:var(--gold);letter-spacing:.28em;
      text-transform:uppercase;font-weight:700;text-align:center;
      font-size:clamp(13px,2vw,16px);margin:0 0 18px;
    }
    .eng-invite .headline{
      font-family:"Playfair Display", serif;font-weight:700;letter-spacing:.18em;text-transform:uppercase;
      color:#999;font-size:clamp(14px,2.3vw,18px);margin:0 0 24px;text-align:center
    }
    .eng-invite .line-1{
      font-family:"Playfair Display", serif;font-weight:700;
      font-size:clamp(18px,3.8vw,32px);
      letter-spacing:.12em;line-height:1.5;margin:0 0 18px;
      text-align:center;color:var(--ink)
    }
    .eng-invite .line-2{
      font-family:"Inter", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      font-size:clamp(16px,2.6vw,19px);line-height:1.9;letter-spacing:.02em;
      margin:0;text-align:center;color:var(--ink)
    }
    .orn{
      position:relative;height:28px;margin:0 auto 28px;
      width:min(360px,70%);opacity:.95
    }
    .orn::before,.orn::after{
      content:"";position:absolute;top:50%;height:1px;width:40%;
      background:linear-gradient(90deg,transparent,var(--rule));
      transform:translateY(-50%);
    }
    .orn::before{left:0}
    .orn::after{right:0;background:linear-gradient(90deg,var(--rule),transparent)}
    .orn .dot{
      position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
      width:8px;height:8px;background:var(--accent);border-radius:2px;
      box-shadow:0 0 0 4px rgba(233,200,155,.15)
    }

    /* Grid */
    .card{background:transparent;border:none;padding:0}
    .grid{display:grid;gap:12px}
    .grid.two{grid-template-columns:1fr 1fr}

    /* Calendar section */
    .calendar{display:grid;place-items:center;gap:14px}
    .calendar .cap{font-size:14px;color:#64748b}
    .calendar img,.calendar svg{max-width:520px;width:100%;height:auto}

    /* Location & Directions section */
    .loc-section{
      padding:40px 16px;
      background:#f7f0e7;
    }
    .loc-title{
      font-family:"Playfair Display", serif;
      font-size:28px;
      font-weight:700;
      text-align:center;
      margin:0 0 24px;
      color:#4b2b1c;
    }
    .loc-card{
      background:#ffffff;
      border-radius:20px;
      padding:20px 18px;
      box-shadow:0 6px 18px rgba(148,116,89,0.08);
      max-width:var(--maxw);
      margin:0 auto 18px;
    }
    .loc-main-header{
      display:flex;
      gap:12px;
      align-items:flex-start;
      margin-bottom:16px;
    }
    .loc-icon{
      font-size:20px;
      line-height:1.2;
      margin-top:2px;
    }
    .loc-name{
      margin:0 0 4px;
      font-weight:700;
      color:#1f2933;
    }
    .loc-addr{
      margin:0;
      font-size:14px;
      color:#4b5563;
      line-height:1.6;
    }
    .loc-copy-row{
      margin-top:14px;
      width:100%;
      border-radius:999px;
      border:1px solid #e5d6c7;
      padding:10px 16px;
      background:#fbf7f1;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      font-size:13px;
      cursor:pointer;
    }
    .loc-copy-text{
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
      color:#4b5563;
    }
    .loc-copy-icon{
      font-size:12px;
      color:#9a7f5a;
      display:flex;
      align-items:center;
      gap:4px;
    }
    .loc-actions{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:16px;
    }
    .loc-btn{
      display:flex;
      align-items:center;
      justify-content:center;
      height:44px;
      border-radius:999px;
      border:none;
      text-decoration:none;
      font-size:14px;
      font-weight:500;
      cursor:pointer;
      background:#e2b08a;
      color:#fff;
    }
    .loc-btn-primary{
      background:#d27b4a;
    }
    .loc-btn span{
      margin-left:6px;
    }
    .loc-subtitle{
      font-weight:600;
      margin:0 0 12px;
      font-size:15px;
      color:#374151;
    }
    .loc-item{
      padding:10px 0;
      border-top:1px solid #f1e4d8;
    }
    .loc-item:first-of-type{
      border-top:none;
    }
    .loc-item-title{
      font-size:14px;
      font-weight:500;
      margin:0 0 4px;
      display:flex;
      align-items:center;
      gap:6px;
      color:#374151;
    }
    .loc-item-text{
      margin:0;
      font-size:13px;
      color:#6b7280;
      line-height:1.6;
    }
    @media (min-width:560px){
      .loc-actions{
        flex-direction:row;
      }
    }

    /* Countdown */
    .countdown-wrap{
      text-align:center;
    }
    .countdown-row{
      display:flex;
      justify-content:center;
      align-items:stretch;
      gap:8px;
      margin-top:8px;
    }
    .time-box{
      min-width:80px;
      padding:18px 14px;
      border-radius:10px;
      background:#f5e8d8;
      border:none;
    }
    .time-label{
      font-size:11px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:#9a7f5a;
      margin-bottom:8px;
    }
    .time-value{
      font-size:22px;
      font-weight:600;
      color:#4b3825;
    }
    .time-colon{
      align-self:center;
      font-size:20px;
      color:#b19773;
      padding:0 2px;
    }
    .count-text{
      margin-top:12px;
      font-size:14px;
      color:var(--muted);
      text-align:center;
    }

    /* Gallery */
    .gallery{
      display:grid;
      gap:8px;
      grid-template-columns:repeat(3,1fr);
    }
    .gallery button{
      padding:0;
      border:none;
      background:transparent;
      cursor:pointer;
      border-radius:8px;
      overflow:hidden;
    }
    .gallery img{
      width:100%;
      aspect-ratio:1/1;
      object-fit:cover;
      border-radius:8px;
    }

    /* Lightbox */
    .lightbox{
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:50;
    }
    .lightbox[hidden]{display:none;}
    .lightbox-backdrop{
      position:absolute;
      inset:0;
      background:rgba(15,23,42,0.75);
    }
    .lightbox-content{
      position:relative;
      z-index:1;
      max-width:min(1024px,94vw);
      max-height:90vh;
      padding:8px;
      border-radius:18px;
      background:#000;
      box-shadow:0 20px 40px rgba(15,23,42,0.6);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .lightbox-content img{
      max-width:100%;
      max-height:86vh;
      border-radius:12px;
    }
    .lightbox-close{
      position:absolute;
      top:8px;
      right:12px;
      width:32px;
      height:32px;
      border-radius:999px;
      border:none;
      background:rgba(15,23,42,0.7);
      color:#e5e7eb;
      font-size:22px;
      line-height:1;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .lightbox-close:hover{
      background:rgba(15,23,42,0.95);
      color:#fff;
    }

    /* Guest Book */
    .gbook { padding: 28px 16px; }
    .gbook .gb-title{
      font-family:"Playfair Display", serif;color:#B9A06B;letter-spacing:.28em;text-transform:uppercase;
      font-weight:700;text-align:center;font-size:clamp(13px,2vw,16px);margin:0 0 18px;
    }
    .gbook .form{display:grid;gap:12px;max-width:var(--maxw);margin:0 auto;}
    .gbook .field{display:grid;gap:6px}
    .gbook input,.gbook textarea{
      width:100%;padding:12px;border:1px solid var(--line);
      border-radius:10px;background:#fff;font-size:16px
    }
    .gbook .msg{margin-top:10px;font-size:14px}
    .gbook .msg.ok{color:#047857}
    .gbook .msg.err{color:#b91c1c}

    /* Guest book message list */
    .gb-list{
      margin-top:18px;padding:0;list-style:none;
      display:grid;gap:10px
    }
    .gb-item{
      border:1px solid var(--line);border-radius:12px;
      padding:12px;background:#fff
    }
    .gb-item .who{
      font-weight:700;margin:0 0 6px;
      display:flex;justify-content:space-between;gap:8px;align-items:center
    }
    .gb-item .txt{
      margin:0;color:#0f172a;
      line-height:1.6;white-space:pre-wrap
    }
    .gb-item .time{
      margin-top:6px;font-size:12px;color:#64748b
    }

    .footer{padding:40px 16px 80px;color:#475569;text-align:center}
    .disclaimer{font-size:12px;color:#64748b;margin-top:16px}
    .sticky-share{
      position:sticky;bottom:0;
      background:#ffffffcc;border-top:1px solid var(--line);
      backdrop-filter:saturate(180%) blur(6px)
    }
    .sticky-share .bar{
      max-width:var(--maxw);margin:0 auto;
      display:flex;gap:8px;padding:10px 12px
    }
  </style>
</head>
<body>
  <div class="wrap" id="top">
    <!-- HERO -->
    <header class="hero">
      <!-- Î≤öÍΩÉ Î†àÏù¥Ïñ¥ (Ï≤´ Î©îÏù∏ ÏÇ¨ÏßÑ ÏúÑÏóêÏÑúÎßå) -->
      <div class="hero-petal-layer" id="petal-layer" aria-hidden="true"></div>

      <img src="·ÑÄ·Ö©·Üº·ÑÄ·Ö¢·ÑÖ·Öµ·Üº·Ñè·Ö≥_·Ñé·Ö•·Üº·Ñé·Ö•·Ü∏·Ñå·Ö°·Üº·ÑÜ·Ö¶·Ñã·Öµ·Ü´·Ñâ·Ö°·Ñå·Öµ·Ü´.png?v=2" alt="Cover image" />
      <div class="badge">2026.06.06 ‚Ä¢ [Venue]</div>
    </header>

    <!-- English invite -->
    <section class="section">
      <div class="eng-invite" aria-label="English invitation">
        <p class="inv-label">INVITATION</p>
        <div class="orn" aria-hidden="true"><span class="dot"></span></div>
        <p class="headline">You‚Äôre invited to celebrate with us.</p>
        <h2 class="line-1">Years of love brought us here.</h2>
        <p class="line-2">
          Today, we‚Äôre celebrating in <strong>Busan, South Korea</strong>
          on <strong>June 6, 2026</strong>.
        </p>
        <div class="orn" style="margin:28px auto 0" aria-hidden="true"><span class="dot"></span></div>
      </div>
    </section>

    <!-- Calendar -->
    <section class="section">
      <div class="calendar">
        <img src="calendar.png" alt="June 2026 calendar with a heart on the 6th" />
      </div>
    </section>

    <!-- Countdown -->
    <section class="section" id="countdown">
      <div class="card countdown-wrap">
        <p class="muted" style="margin:0 0 6px">Countdown</p>

        <div class="countdown-row">
          <div class="time-box">
            <div class="time-label">DAYS</div>
            <div id="cd-days" class="time-value">000</div>
          </div>

          <div class="time-colon">:</div>

          <div class="time-box">
            <div class="time-label">HOUR</div>
            <div id="cd-hours" class="time-value">00</div>
          </div>

          <div class="time-colon">:</div>

          <div class="time-box">
            <div class="time-label">MIN</div>
            <div id="cd-mins" class="time-value">00</div>
          </div>

          <div class="time-colon">:</div>

          <div class="time-box">
            <div class="time-label">SEC</div>
            <div id="cd-secs" class="time-value">00</div>
          </div>
        </div>

        <p class="count-text">
          The wedding of Daniel &amp; Diana is in
          <strong><span id="cd-days-text">0</span> days</strong>.
        </p>
      </div>
    </section>

    <!-- When & Where -->
    <section class="section">
      <div class="card">
        <p class="muted" style="margin:0 0 6px">When &amp; Where</p>
        <div class="grid two">
          <div>
            <div class="muted">Date &amp; Time</div>
            <h3 style="margin:6px 0 0">2026.06.06 (Sat) ‚Ä¢ 13:00</h3>
          </div>
          <div>
            <div class="muted">Venue</div>
            <h3 style="margin:6px 0 0">[GRAND BLANC] [Mirabelle Garden]</h3>
          </div>
        </div>
        <div style="height:12px"></div>
        <div class="grid two">
          <a class="btn brand" id="btnAddCal" href="#">Save to Calendar</a>
          <a class="btn" target="_blank" rel="noopener" href="https://maps.google.com/?q=%EA%B7%B8%EB%9E%9C%EB%93%9C%EB%B8%94%EB%9E%91%20%EC%84%BC%ED%85%80">Open Map</a>
        </div>
      </div>
    </section>

    <!-- Location & Directions (NEW) -->
    <section class="loc-section" id="location">
      <h2 class="loc-title">Location &amp; Directions</h2>

      <div class="loc-card">
        <div class="loc-main-header">
          <div class="loc-icon">üìç</div>
          <div>
            <p class="loc-name">[GRAND BLANC] Mirabelle Garden</p>
            <p class="loc-addr">Busan, Haeundae-gu, Centum area (Í∑∏ÎûúÎìúÎ∏îÎûë ÎØ∏ÎùºÎ≤® Í∞ÄÎì†)</p>
            <p class="loc-addr">3rd Floor, Grand Blanc Wedding Hall</p>
          </div>
        </div>

        <button type="button" class="loc-copy-row" id="btnCopyAddr">
          <span class="loc-copy-text" id="locCopyText">
            Busan, Haeundae-gu, Centum area, Grand Blanc Wedding Hall, Mirabelle Garden (3F)
          </span>
          <span class="loc-copy-icon">
            üìã Copy Address
          </span>
        </button>

        <div class="loc-actions">
          <a
            class="loc-btn loc-btn-primary"
            href="https://maps.google.com/?q=%EA%B7%B8%EB%9E%9C%EB%93%9C%EB%B8%94%EB%9E%91%20%EC%84%BC%ED%85%80"
            target="_blank"
            rel="noopener"
          >
            Google Maps
          </a>
          <a
            class="loc-btn"
            href="https://map.naver.com/p/search/%EA%B7%B8%EB%9E%9C%EB%93%9C%EB%B8%94%EB%9E%91%20%EC%84%BC%ED%85%80"
            target="_blank"
            rel="noopener"
          >
            Naver Map
          </a>
        </div>
      </div>

      <div class="loc-card">
        <p class="loc-subtitle">Getting There</p>

        <div class="loc-item">
          <p class="loc-item-title">üöá By Subway</p>
          <p class="loc-item-text">
            Take Line 2 to Centum City Station. Use Exit 6 and walk about 5 minutes toward Grand Blanc Wedding Hall.
          </p>
        </div>

        <div class="loc-item">
          <p class="loc-item-title">üöå By Bus</p>
          <p class="loc-item-text">
            Nearby stops: Centum City area bus stops. Please check Google Maps or Naver Map for the best route on the day.
          </p>
        </div>

        <div class="loc-item">
          <p class="loc-item-title">üöó By Car</p>
          <p class="loc-item-text">
            Parking is available in the building. On-site staff will guide you to the wedding hall floor.
          </p>
        </div>
      </div>
    </section>

    <!-- Gallery -->
    <section class="section">
      <div class="card">
        <p class="muted" style="margin:0 0 6px">Gallery</p>
        <div class="gallery">
          <button type="button" data-img="1.jpg" aria-label="Open photo 1">
            <img src="1.jpg" alt="Wedding photo 1">
          </button>
          <button type="button" data-img="2.jpg" aria-label="Open photo 2">
            <img src="2.jpg" alt="Wedding photo 2">
          </button>
          <button type="button" data-img="3.jpg" aria-label="Open photo 3">
            <img src="3.jpg" alt="Wedding photo 3">
          </button>
          <button type="button" data-img="4.jpg" aria-label="Open photo 4">
            <img src="4.jpg" alt="Wedding photo 4">
          </button>
          <button type="button" data-img="5.jpg" aria-label="Open photo 5">
            <img src="5.jpg" alt="Wedding photo 5">
          </button>
          <button type="button" data-img="6.jpg" aria-label="Open photo 6">
            <img src="6.jpg" alt="Wedding photo 6">
          </button>
          <button type="button" data-img="7.jpg" aria-label="Open photo 7">
            <img src="7.jpg" alt="Wedding photo 7">
          </button>
          <button type="button" data-img="8.jpg" aria-label="Open photo 8">
            <img src="8.jpg" alt="Wedding photo 8">
          </button>
          <button type="button" data-img="9.jpg" aria-label="Open photo 9">
            <img src="9.jpg" alt="Wedding photo 9">
          </button>
          <button type="button" data-img="10.jpg" aria-label="Open photo 10">
            <img src="10.jpg" alt="Wedding photo 10">
          </button>
        </div>
      </div>
    </section>

    <!-- Lightbox modal -->
    <div id="lightbox" class="lightbox" hidden>
      <div class="lightbox-backdrop"></div>
      <div class="lightbox-content" role="dialog" aria-modal="true" aria-label="Photo viewer">
        <button class="lightbox-close" type="button" aria-label="Close">&times;</button>
        <img id="lightboxImg" src="" alt="Wedding photo enlarged">
      </div>
    </div>

    <!-- Account Info (optional) -->
    <section class="section">
      <div class="card">
        <p class="muted" style="margin:0 0 6px">Account Info (optional)</p>
        <ul class="list" style="list-style:none;padding:0;margin:12px 0 0">
          <li class="kv" style="display:flex;justify-content:space-between;gap:12px;padding:8px 0">
            <span>Groom‚Äôs side</span>
            <strong>OO Bank 123-456-789012 (Hong Gil-dong)</strong>
          </li>
          <li class="kv" style="display:flex;justify-content:space-between;gap:12px;padding:8px 0;border-top:1px dashed var(--line)">
            <span>Bride‚Äôs side</span>
            <strong>OO Bank 987-654-321098 (Kim Min-ji)</strong>
          </li>
        </ul>
      </div>
    </section>

    <!-- Guest Book -->
    <section class="section gbook" id="guestbook">
      <p class="gb-title">Guest Book</p>

      <form id="gbForm" class="form" novalidate>
        <div class="field">
          <input type="text" id="gb_name" name="name" placeholder="Your name" required />
        </div>
        <div class="field">
          <input
            type="password"
            id="gb_pin"
            name="pin"
            inputmode="numeric"
            minlength="4"
            maxlength="6"
            placeholder="Passcode (4‚Äì6 digits)"
            required
          />
        </div>
        <div class="field">
          <textarea id="gb_message" name="message" rows="3" placeholder="Write a message for the couple" required></textarea>
        </div>

        <button id="gbSubmit" class="btn brand" type="submit">Leave a Message</button>

        <p id="gbOk"  class="msg ok"  hidden>Thank you! Your message has been posted.</p>
        <p id="gbErr" class="msg err" hidden>Something went wrong. Please try again.</p>
      </form>

      <!-- Message list -->
      <ul id="gbList" class="gb-list"></ul>
    </section>

    <!-- RSVP button -->
    <section class="section" id="rsvp-cta">
      <div class="card" style="text-align:center">
        <a class="btn brand" href="./rsvp.html">Open RSVP Form</a>
      </div>
    </section>

    <!-- Sticky share -->
    <div class="sticky-share">
      <div class="bar">
        <button class="btn" id="btnCopy">Copy Link</button>
        <a class="btn brand" href="#top">Back to Top</a>
      </div>
    </div>

    <footer class="footer">
      <div>Thank you. Have a safe trip üôè</div>
      <div class="disclaimer">Optional footer text can go here.</div>
    </footer>
  </div>

  <script>
    // Copy link
    document.getElementById('btnCopy').addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(location.href);
        alert('Link copied!');
      } catch {
        alert('Copy failed. Please press and hold the address to copy it.');
      }
    });

    // Copy address (Location card)
    document.getElementById('btnCopyAddr')?.addEventListener('click', async () => {
      const textEl = document.getElementById('locCopyText');
      const text = textEl?.textContent?.trim() || '';
      if (!text) return;

      try{
        await navigator.clipboard.writeText(text);
        alert('Address copied.');
      }catch{
        alert('Copy failed. Please copy it manually.');
      }
    });

    // Calendar (ICS)
    document.getElementById('btnAddCal')?.addEventListener('click', () => {
      const title='Wedding of Daniel & Diana';
      const start=new Date(2026,5,6,13,30);
      const end=new Date(2026,5,6,15,30);
      const loc='[Venue / Hall Name]';
      const pad=n=>String(n).padStart(2,'0');
      const toICS=d=>`${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}T${pad(d.getHours())}${pad(d.getMinutes())}00`;
      const ics=`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Mobile Invitation//EN
BEGIN:VEVENT
UID:${Date.now()}@inv
DTSTAMP:${toICS(new Date())}
DTSTART:${toICS(start)}
DTEND:${toICS(end)}
SUMMARY:${title}
LOCATION:${loc}
END:VEVENT
END:VCALENDAR`;
      const blob=new Blob([ics],{type:'text/calendar'}); const url=URL.createObjectURL(blob);
      const a=document.createElement('a'); a.href=url; a.download='wedding-invite.ics'; a.click(); URL.revokeObjectURL(url);
    });

    // Countdown (2026-06-06 13:00 KST)
    (function setupCountdown(){
      const daysEl   = document.getElementById('cd-days');
      const hoursEl  = document.getElementById('cd-hours');
      const minsEl   = document.getElementById('cd-mins');
      const secsEl   = document.getElementById('cd-secs');
      const daysTxt  = document.getElementById('cd-days-text');

      if (!daysEl || !hoursEl || !minsEl || !secsEl) return;

      const target = new Date("2026-06-06T13:00:00+09:00").getTime();

      function update(){
        const now = Date.now();
        let diff = target - now;
        if (diff < 0) diff = 0;

        const days  = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
        const mins  = Math.floor((diff / (1000 * 60)) % 60);
        const secs  = Math.floor((diff / 1000) % 60);

        daysEl.textContent  = String(days).padStart(3,'0');
        hoursEl.textContent = String(hours).padStart(2,'0');
        minsEl.textContent  = String(mins).padStart(2,'0');
        secsEl.textContent  = String(secs).padStart(2,'0');
        if (daysTxt) daysTxt.textContent = days;
      }

      update();
      setInterval(update, 1000);
    })();

    // Lightbox for gallery
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightboxImg');
    const lightboxClose = document.querySelector('.lightbox-close');

    function openLightbox(src){
      if (!lightbox || !lightboxImg || !src) return;
      lightboxImg.src = src;
      lightbox.removeAttribute('hidden');
    }

    function closeLightbox(){
      if (!lightbox || !lightboxImg) return;
      lightbox.setAttribute('hidden','');
      lightboxImg.src = '';
    }

    document.querySelectorAll('.gallery [data-img]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const src = btn.getAttribute('data-img');
        openLightbox(src);
      });
    });

    lightboxClose?.addEventListener('click', closeLightbox);

    lightbox?.addEventListener('click', (e)=>{
      if (e.target === lightbox || e.target.classList.contains('lightbox-backdrop')) {
        closeLightbox();
      }
    });

    document.addEventListener('keydown', (e)=>{
      if (e.key === 'Escape' && lightbox && !lightbox.hasAttribute('hidden')) {
        closeLightbox();
      }
    });

    // Hero cherry blossom petals (Îã®Ïàú Î≤ÑÏ†Ñ)
    (function makePetals(){
      const container = document.getElementById('petal-layer');
      if (!container) return;

      const COUNT = 10;

      for (let i = 0; i < COUNT; i++) {
        const p = document.createElement('div');
        p.className = 'petal';

        p.style.left = (Math.random() * 100) + '%';
        p.style.animationDuration = (Math.random() * 8 + 6) + 's';
        p.style.animationDelay = (Math.random() * -14) + 's';

        container.appendChild(p);
      }
    })();
  </script>

  <!-- Supabase Guest Book -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

    const SUPABASE_URL = "https://khddckyznivjoluwtvxo.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtoZGRja3l6bml2am9sdXd0dnhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3MTk1NDYsImV4cCI6MjA3ODI5NTU0Nn0.zblwD4ETNzl1YlFBTfpqvxkvGPrE1RhawPLC9_iUxoE";

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    async function sha256(str){
      const data = new TextEncoder().encode(str);
      const hash = await crypto.subtle.digest('SHA-256', data);
      return [...new Uint8Array(hash)].map(b=>b.toString(16).padStart(2,'0')).join('');
    }

    const listEl = document.getElementById('gbList');

    function prependMessage({id, name, message, created_at}){
      const li = document.createElement('li');
      li.className = 'gb-item';
      if (id) li.dataset.id = id;
      const when = created_at ? new Date(created_at) : new Date();
      const safe = message.replace(/</g,'&lt;').replace(/>/g,'&gt;');
      li.innerHTML = `
        <p class="who">
          <span>${name}</span>
          <button class="icon-btn btn-delete" type="button" aria-label="Delete"></button>
        </p>
        <p class="txt">${safe}</p>
        <div class="time">${when.toLocaleString()}</div>
      `;
      listEl.prepend(li);
    }

    async function loadLatest(limit=30){
      const { data, error } = await supabase.rpc('list_guestbook', { limit_count: limit });
      if (error) {
        console.error('list_guestbook error:', error);
        return;
      }
      listEl.innerHTML = '';
      (data || []).forEach(prependMessage);
    }

    const form = document.getElementById('gbForm');
    const btn  = document.getElementById('gbSubmit');
    const ok   = document.getElementById('gbOk');
    const err  = document.getElementById('gbErr');

    form?.addEventListener('submit', async (e)=>{
      e.preventDefault();
      ok.hidden = true; err.hidden = true;

      const name = document.getElementById('gb_name').value.trim();
      const pin  = document.getElementById('gb_pin').value.trim();
      const msg  = document.getElementById('gb_message').value.trim();

      if(!name || !pin || !msg){
        err.textContent = "Please fill in all fields.";
        err.hidden = false; return;
      }
      if(pin.length < 4 || pin.length > 6){
        err.textContent = "Passcode must be 4‚Äì6 digits.";
        err.hidden = false; return;
      }

      btn.disabled = true; btn.textContent = "Sending‚Ä¶";

      try{
        const pin_hash = await sha256(pin);
        const clientId = crypto.randomUUID();

        const { error } = await supabase
          .from('guestbook')
          .insert({ id: clientId, name, message: msg, pin_hash });

        if (error) {
          console.error(error);
          err.textContent = "An error occurred. Please try again.";
          err.hidden = false;
        } else {
          prependMessage({
            id: clientId,
            name,
            message: msg,
            created_at: new Date().toISOString()
          });
          form.reset();
          ok.hidden = false;
        }
      }catch(e2){
        console.error(e2);
        err.textContent = "An error occurred. Please try again.";
        err.hidden = false;
      }finally{
        btn.disabled = false; btn.textContent = "Leave a Message";
      }
    });

    document.addEventListener('click', async (e)=>{
      const btn = e.target.closest('.btn-delete');
      if (!btn) return;

      const li = btn.closest('.gb-item');
      const id = li?.dataset?.id;
      if (!id) { alert('No message ID found.'); return; }

      const pin = prompt('Enter your passcode to delete this message');
      if (!pin) return;

      btn.disabled = true;

      const { data, error } = await supabase.rpc('delete_guestbook_entry', {
        _id: id,
        _pin: pin
      });

      if (error) {
        console.error('delete_guestbook_entry error:', error);
        alert('Delete failed. Please try again.');
      } else if (data === true) {
        li.remove();
      } else {
        alert('Passcode did not match.');
      }

      btn.disabled = false;
    });

    loadLatest();
  </script>
</body>
</html>
