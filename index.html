<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wedding of Daniel & Diana</title>

  <!-- OG -->
  <meta property="og:title" content="Wedding of Daniel & Diana" />
  <meta property="og:description" content="2026.06.06 | [Venue / Hall Name]" />
  <meta property="og:image" content="·ÑÄ·Ö©·Üº·ÑÄ·Ö¢·ÑÖ·Öµ·Üº·Ñè·Ö≥_·Ñé·Ö•·Üº·Ñé·Ö•·Ü∏·Ñå·Ö°·Üº·ÑÜ·Ö¶·Ñã·Öµ·Ü´·Ñâ·Ö°·Ñå·Öµ·Ü´.png" />
  <meta property="og:url" content="https://Diana101S.github.io/WeddingInvitation/" />
  <meta property="og:type" content="website" />
  <meta name="format-detection" content="telephone=no" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&family=Playfair+Display:wght@600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#FFFFFF;
      --ink:#0f172a;--sub:#334155;--brand:#86AEDB;--soft:#f1f5f9;--line:#e7e7e7;
      --muted:#6B7280;--accent:#E9C89B;--rule:#E6D7BD;--gold:#B9A06B;
      --maxw:720px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);
      font-family:Pretendard,system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif}
    img{max-width:100%;display:block}
    a{color:inherit;text-decoration:none}
    .wrap{max-width:var(--maxw);margin:0 auto}

    /* HERO */
    .hero{position:relative}
    .hero img{width:100%;height:auto}
    .badge{position:absolute;right:16px;bottom:16px;background:#ffffffdd;color:var(--ink);padding:8px 12px;border-radius:999px;font-weight:600;font-size:14px;backdrop-filter:saturate(180%) blur(6px)}

    /* Layout */
    .section{padding:28px 16px}

    /* Buttons */
    .btn{display:inline-flex;align-items:center;justify-content:center;height:44px;padding:0 14px;border-radius:10px;border:1px solid var(--line);background:#fff;cursor:pointer}
    .btn.brand{background:var(--brand);border-color:var(--brand);color:#fff;font-weight:700}

    /* Icon button: borderless / transparent + thin black X */
    .icon-btn{
      position:relative;
      width:24px;height:24px;
      border:none;background:transparent;cursor:pointer;
      padding:0;line-height:1;
    }
    .icon-btn::before,.icon-btn::after{
      content:"";position:absolute;left:50%;top:50%;
      width:14px;height:1px;background:#0f172a;opacity:.85;transform-origin:center;
    }
    .icon-btn::before{ transform:translate(-50%,-50%) rotate(45deg); }
    .icon-btn::after { transform:translate(-50%,-50%) rotate(-45deg); }
    .icon-btn:hover::before,.icon-btn:hover::after{ opacity:1; }
    .icon-btn:focus-visible{ outline:2px solid #cbd5e1; outline-offset:2px; border-radius:6px; }

    .muted{color:var(--sub)}
    .map{border:0;width:100%;height:280px;border-radius:12px}

    /* English invite block */
    .eng-invite{padding:20px 0}
    .eng-invite .inv-label{
      font-family:"Playfair Display", serif;color:var(--gold);letter-spacing:.28em;
      text-transform:uppercase;font-weight:700;text-align:center;font-size:clamp(13px,2vw,16px);margin:0 0 18px;
    }
    .eng-invite .headline{
      font-family:"Playfair Display", serif;font-weight:700;letter-spacing:.18em;text-transform:uppercase;
      color:#999; font-size:clamp(14px,2.3vw,18px);margin:0 0 24px;text-align:center
    }
    .eng-invite .line-1{
      font-family:"Playfair Display", serif;font-weight:700;font-size:clamp(18px,3.8vw,32px);
      letter-spacing:.12em;line-height:1.5;margin:0 0 18px;text-align:center;color:var(--ink)
    }
    .eng-invite .line-2{
      font-family:"Inter", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      font-size:clamp(16px,2.6vw,19px);line-height:1.9;letter-spacing:.02em;margin:0;text-align:center;color:var(--ink)
    }
    .orn{position:relative;height:28px;margin:0 auto 28px;width:min(360px,70%);opacity:.95}
    .orn::before,.orn::after{content:"";position:absolute;top:50%;height:1px;width:40%;background:linear-gradient(90deg,transparent,var(--rule));transform:translateY(-50%)}
    .orn::before{left:0}
    .orn::after{right:0;background:linear-gradient(90deg,var(--rule),transparent)}
    .orn .dot{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:8px;height:8px;background:var(--accent);border-radius:2px;box-shadow:0 0 0 4px rgba(233,200,155,.15)}

    /* Grid */
    .card{background:transparent;border:none;padding:0}
    .grid{display:grid;gap:12px}
    .grid.two{grid-template-columns:1fr 1fr}

    /* Calendar section */
    .calendar{display:grid;place-items:center;gap:14px}
    .calendar .cap{font-size:14px;color:#64748b}
    .calendar img,.calendar svg{max-width:520px;width:100%;height:auto}

    /* Gallery */
    .gallery{
      display:grid;
      gap:8px;
      grid-template-columns:repeat(3,1fr);
    }
    .gallery a{
      display:block;
      border-radius:8px;
      overflow:hidden;
    }
    .gallery img{
      width:100%;
      aspect-ratio:1/1;
      object-fit:cover;
      border-radius:8px;
    }

    /* Guest Book */
    .gbook { padding: 28px 16px; }
    .gbook .gb-title{
      font-family:"Playfair Display", serif;color:#B9A06B;letter-spacing:.28em;text-transform:uppercase;
      font-weight:700;text-align:center;font-size:clamp(13px,2vw,16px);margin:0 0 18px;
    }
    .gbook .form{display:grid;gap:12px;max-width:var(--maxw);margin:0 auto;}
    .gbook .field{display:grid;gap:6px}
    .gbook input,.gbook textarea{width:100%;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fff;font-size:16px}
    .gbook .msg{margin-top:10px;font-size:14px}
    .gbook .msg.ok{color:#047857}
    .gbook .msg.err{color:#b91c1c}

    /* Guest book message list */
    .gb-list{margin-top:18px;padding:0;list-style:none;display:grid;gap:10px}
    .gb-item{border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff}
    .gb-item .who{font-weight:700;margin:0 0 6px;display:flex;justify-content:space-between;gap:8px;align-items:center}
    .gb-item .txt{margin:0;color:#0f172a;line-height:1.6;white-space:pre-wrap}
    .gb-item .time{margin-top:6px;font-size:12px;color:#64748b}

    .footer{padding:40px 16px 80px;color:#475569;text-align:center}
    .disclaimer{font-size:12px;color:#64748b;margin-top:16px}
    .sticky-share{position:sticky;bottom:0;background:#ffffffcc;border-top:1px solid var(--line);backdrop-filter:saturate(180%) blur(6px)}
    .sticky-share .bar{max-width:var(--maxw);margin:0 auto;display:flex;gap:8px;padding:10px 12px}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- HERO -->
    <header class="hero">
      <img src="·ÑÄ·Ö©·Üº·ÑÄ·Ö¢·ÑÖ·Öµ·Üº·Ñè·Ö≥_·Ñé·Ö•·Üº·Ñé·Ö•·Ü∏·Ñå·Ö°·Üº·ÑÜ·Ö¶·Ñã·Öµ·Ü´·Ñâ·Ö°·Ñå·Öµ·Ü´.png?v=2" alt="Cover image" />
      <div class="badge">2026.06.06 ‚Ä¢ [Venue]</div>
    </header>

    <!-- English invite -->
    <section class="section">
      <div class="eng-invite" aria-label="English invitation">
        <p class="inv-label">INVITATION</p>
        <div class="orn" aria-hidden="true"><span class="dot"></span></div>
        <p class="headline">You‚Äôre invited to celebrate with us.</p>
        <h2 class="line-1">Years of love brought us here.</h2>
        <p class="line-2">Today, we‚Äôre celebrating in <strong>Busan, South Korea</strong> on <strong>June 6, 2026</strong>.</p>
        <div class="orn" style="margin:28px auto 0" aria-hidden="true"><span class="dot"></span></div>
      </div>
    </section>

    <!-- Calendar -->
    <section class="section">
      <div class="calendar">
        <img src="calendar.png" alt="June 2026 calendar with a heart on the 6th" />
        <div class="cap">Save the Date ‚Äî 2026.06.06</div>
      </div>
    </section>

    <!-- When & Where -->
    <section class="section">
      <div class="card">
        <p class="muted" style="margin:0 0 6px">When &amp; Where</p>
        <div class="grid two">
          <div>
            <div class="muted">Date &amp; Time</div>
            <h3 style="margin:6px 0 0">2026.06.06 (Sat) ‚Ä¢ 13:00</h3>
          </div>
          <div>
            <div class="muted">Venue</div>
            <h3 style="margin:6px 0 0">[GRAND BLANC] [Mirabelle Garden]</h3>
          </div>
        </div>
        <div style="height:12px"></div>
        <div class="grid two">
          <a class="btn brand" id="btnAddCal" href="#">Save to Calendar</a>
          <a class="btn" target="_blank" rel="noopener" href="https://maps.google.com/?q=%EC%98%88%EC%8B%9D%EC%9E%A5">Open Map</a>
        </div>
      </div>
    </section>

    <!-- Directions -->
    <section class="section">
      <div class="card">
        <p class="muted" style="margin:0 0 6px">Directions</p>
        <iframe
            class="map"
            loading="lazy"
            allowfullscreen
            referrerpolicy="no-referrer-when-downgrade"
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3261.6071287621585!2d129.12945411139236!3d35.166417572644185!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x356892c7a3bb7249%3A0xaffba3b439d3a200!2z6re4656c65Oc67iU656RIOybqOuUqe2ZgA!5e0!3m2!1sko!2skr!4v1762822591444!5m2!1sko!2skr">
        </iframe>
        <p class="muted" style="margin-top:8px">Please add details about public transportation and parking here.</p>
      </div>
    </section>

    <!-- Gallery -->
    <section class="section">
      <div class="card">
        <p class="muted" style="margin:0 0 6px">Gallery</p>
        <div class="gallery">
          <a href="1.jpg" target="_blank" rel="noopener">
            <img src="1.jpg" alt="Wedding photo 1">
          </a>
          <a href="2.jpg" target="_blank" rel="noopener">
            <img src="2.jpg" alt="Wedding photo 2">
          </a>
          <a href="3.jpg" target="_blank" rel="noopener">
            <img src="3.jpg" alt="Wedding photo 3">
          </a>
          <a href="4.jpg" target="_blank" rel="noopener">
            <img src="4.jpg" alt="Wedding photo 4">
          </a>
          <a href="5.jpg" target="_blank" rel="noopener">
            <img src="5.jpg" alt="Wedding photo 5">
          </a>
          <a href="6.jpg" target="_blank" rel="noopener">
            <img src="6.jpg" alt="Wedding photo 6">
          </a>
          <a href="7.jpg" target="_blank" rel="noopener">
            <img src="7.jpg" alt="Wedding photo 7">
          </a>
          <a href="8.jpg" target="_blank" rel="noopener">
            <img src="8.jpg" alt="Wedding photo 8">
          </a>
          <a href="9.jpg" target="_blank" rel="noopener">
            <img src="9.jpg" alt="Wedding photo 9">
          </a>
          <a href="10.jpg" target="_blank" rel="noopener">
            <img src="10.jpg" alt="Wedding photo 10">
          </a>
        </div>
      </div>
    </section>

    <!-- Account Info (optional) -->
    <section class="section">
      <div class="card">
        <p class="muted" style="margin:0 0 6px">Account Info (optional)</p>
        <ul class="list" style="list-style:none;padding:0;margin:12px 0 0">
          <li class="kv" style="display:flex;justify-content:space-between;gap:12px;padding:8px 0">
            <span>Groom‚Äôs side</span><strong>OO Bank 123-456-789012 (Hong Gil-dong)</strong>
          </li>
          <li class="kv" style="display:flex;justify-content:space-between;gap:12px;padding:8px 0;border-top:1px dashed var(--line)">
            <span>Bride‚Äôs side</span><strong>OO Bank 987-654-321098 (Kim Min-ji)</strong>
          </li>
        </ul>
      </div>
    </section>

    <!-- Guest Book -->
    <section class="section gbook" id="guestbook">
      <p class="gb-title">Guest Book</p>

      <form id="gbForm" class="form" novalidate>
        <div class="field">
          <input type="text" id="gb_name" name="name" placeholder="Your name" required />
        </div>
        <div class="field">
          <input
            type="password"
            id="gb_pin"
            name="pin"
            inputmode="numeric"
            minlength="4"
            maxlength="6"
            placeholder="Passcode (4‚Äì6 digits)"
            required
          />
        </div>
        <div class="field">
          <textarea id="gb_message" name="message" rows="3" placeholder="Write a message for the couple" required></textarea>
        </div>

        <button id="gbSubmit" class="btn brand" type="submit">Leave a Message</button>

        <p id="gbOk"  class="msg ok"  hidden>Thank you! Your message has been posted.</p>
        <p id="gbErr" class="msg err" hidden>Something went wrong. Please try again.</p>
      </form>

      <!-- Message list -->
      <ul id="gbList" class="gb-list"></ul>
    </section>

    <!-- RSVP button -->
    <section class="section" id="rsvp-cta">
      <div class="card" style="text-align:center">
        <a class="btn brand" href="./rsvp.html">Open RSVP Form</a>
      </div>
    </section>

    <!-- Sticky share -->
    <div class="sticky-share">
      <div class="bar">
        <button class="btn" id="btnCopy">Copy Link</button>
        <a class="btn brand" href="#top">Back to Top</a>
      </div>
    </div>

    <footer class="footer">
      <div>Thank you. Have a safe trip üôè</div>
      <div class="disclaimer">Optional footer text can go here.</div>
    </footer>
  </div>

  <script>
    // Copy link
    document.getElementById('btnCopy').addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(location.href);
        alert('Link copied!');
      } catch {
        alert('Copy failed. Please press and hold the address to copy it.');
      }
    });

    // Calendar (ICS)
    document.getElementById('btnAddCal')?.addEventListener('click', () => {
      const title='Wedding of Daniel & Diana';
      const start=new Date(2026,5,6,13,30);
      const end=new Date(2026,5,6,15,30);
      const loc='[Venue / Hall Name]';
      const pad=n=>String(n).padStart(2,'0');
      const toICS=d=>`${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}T${pad(d.getHours())}${pad(d.getMinutes())}00`;
      const ics=`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Mobile Invitation//EN
BEGIN:VEVENT
UID:${Date.now()}@inv
DTSTAMP:${toICS(new Date())}
DTSTART:${toICS(start)}
DTEND:${toICS(end)}
SUMMARY:${title}
LOCATION:${loc}
END:VEVENT
END:VCALENDAR`;
      const blob=new Blob([ics],{type:'text/calendar'}); const url=URL.createObjectURL(blob);
      const a=document.createElement('a'); a.href=url; a.download='wedding-invite.ics'; a.click(); URL.revokeObjectURL(url);
    });
  </script>

  <!-- Supabase Guest Book: save + delete + load on refresh -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

    // ‚¨á‚¨á Replace with your actual values ‚¨á‚¨á
    const SUPABASE_URL = "https://khddckyznivjoluwtvxo.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtoZGRja3l6bml2am9sdXd0dnhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3MTk1NDYsImV4cCI6MjA3ODI5NTU0Nn0.zblwD4ETNzl1YlFBTfpqvxkvGPrE1RhawPLC9_iUxoE";

    // ‚¨Ü‚¨Ü Replace with your actual values ‚¨Ü‚¨Ü

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    async function sha256(str){
      const data = new TextEncoder().encode(str);
      const hash = await crypto.subtle.digest('SHA-256', data);
      return [...new Uint8Array(hash)].map(b=>b.toString(16).padStart(2,'0')).join('');
    }

    const listEl = document.getElementById('gbList');

    // Message card renderer (with delete icon button)
    function prependMessage({id, name, message, created_at}){
      const li = document.createElement('li');
      li.className = 'gb-item';
      if (id) li.dataset.id = id;
      const when = created_at ? new Date(created_at) : new Date();
      const safe = message.replace(/</g,'&lt;').replace(/>/g,'&gt;');
      li.innerHTML = `
        <p class="who">
          <span>${name}</span>
          <button class="icon-btn btn-delete" type="button" aria-label="Delete"></button>
        </p>
        <p class="txt">${safe}</p>
        <div class="time">${when.toLocaleString()}</div>
      `;
      listEl.prepend(li);
    }

    // Initial load: fetch recent messages from the server (read-only RPC)
    async function loadLatest(limit=30){
      const { data, error } = await supabase.rpc('list_guestbook', { limit_count: limit });
      if (error) {
        console.error('list_guestbook error:', error);
        return;
      }
      listEl.innerHTML = '';
      (data || []).forEach(prependMessage);
    }

    const form = document.getElementById('gbForm');
    const btn  = document.getElementById('gbSubmit');
    const ok   = document.getElementById('gbOk');
    const err  = document.getElementById('gbErr');

    // Submit ‚Üí insert (client UUID) ‚Üí render immediately
    form?.addEventListener('submit', async (e)=>{
      e.preventDefault();
      ok.hidden = true; err.hidden = true;

      const name = document.getElementById('gb_name').value.trim();
      const pin  = document.getElementById('gb_pin').value.trim();
      const msg  = document.getElementById('gb_message').value.trim();

      if(!name || !pin || !msg){
        err.textContent = "Please fill in all fields.";
        err.hidden = false; return;
      }
      if(pin.length < 4 || pin.length > 6){
        err.textContent = "Passcode must be 4‚Äì6 digits.";
        err.hidden = false; return;
      }

      btn.disabled = true; btn.textContent = "Sending‚Ä¶";

      try{
        const pin_hash = await sha256(pin);
        const clientId = crypto.randomUUID();

        const { error } = await supabase
          .from('guestbook')
          .insert({ id: clientId, name, message: msg, pin_hash });

        if (error) {
          console.error(error);
          err.textContent = "An error occurred. Please try again.";
          err.hidden = false;
        } else {
          prependMessage({
            id: clientId,
            name,
            message: msg,
            created_at: new Date().toISOString()
          });
          form.reset();
          ok.hidden = false;
        }
      }catch(e2){
        console.error(e2);
        err.textContent = "An error occurred. Please try again.";
        err.hidden = false;
      }finally{
        btn.disabled = false; btn.textContent = "Leave a Message";
      }
    });

    // Delete (click icon ‚Üí enter PIN ‚Üí RPC)
    document.addEventListener('click', async (e)=>{
      const btn = e.target.closest('.btn-delete');
      if (!btn) return;

      const li = btn.closest('.gb-item');
      const id = li?.dataset?.id;
      if (!id) { alert('No message ID found.'); return; }

      const pin = prompt('Enter your passcode to delete this message');
      if (!pin) return;

      btn.disabled = true;

      const { data, error } = await supabase.rpc('delete_guestbook_entry', {
        _id: id,
        _pin: pin
      });

      if (error) {
        console.error('delete_guestbook_entry error:', error);
        alert('Delete failed. Please try again.');
      } else if (data === true) {
        li.remove();
      } else {
        alert('Passcode did not match.');
      }

      btn.disabled = false;
    });

    // Load messages on first render
    loadLatest();
  </script>
</body>
</html>
